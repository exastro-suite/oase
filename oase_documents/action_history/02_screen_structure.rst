========================================
2 OASE アクション履歴画面の画面構成
========================================

本章では、OASE アクション履歴画面の画面構成と、各構成要素について説明します。


2.1 基本画面構成
================


| アクション履歴画面の画面構成は次のとおりです。

.. figure:: ../images/action_history/action_history_01.png
   :scale: 100%
   :align: center

   図 2.1-1 一覧画面構成


| アクション履歴画面の各構成要素と、その機能は次の表のとおりです。

.. csv-table:: 表 2.1-1 機能説明
   :header: No., 構成要素, 説明
   :widths: 5, 20, 60

   1, 作業画面名, 現在表示している作業画面の名称です。
   2, 一覧, アクション履歴の情報が表示されます。


.. note::
    ディシジョンテーブル画面のルール種別毎に設定するグループ権限の中にある、
    「アクション履歴」が「権限なし」のグループに所属しているユーザの場合は、
    アクション履歴画面の一覧に対象となるルール種別の履歴情報は表示されません。


| 一覧で表示される状態のアイコンは次のとおりです。

.. list-table:: 表 2.1-1-1 ステータスアイコン
    :widths: 5, 20, 60
    :header-rows: 1

    * - No.
      - アイコン
      - 説明
    * - 1
      - .. figure:: ../images/action_history/check.png
           :scale: 20%
      - アクション正常終了の時に表示されるステータスアイコンです。
    * - 2
      - .. figure:: ../images/action_history/gear.png
           :scale: 20%
      - アクション実行中に表示されるステータスアイコンです。
    * - 3
      - .. figure:: ../images/action_history/cross.png
           :scale: 20%
      - アクション強制終了の時に表示されるステータスアイコンです。
    * - 4
      - .. figure:: ../images/action_history/stop.png
           :scale: 20%
      - アクション承認待ちの時に表示されるステータスアイコンです。
    * - 5
      - .. figure:: ../images/action_history/square.png
           :scale: 20%
      - アクション承認待ちキャンセル時に表示されるステータスアイコンです。
    * - 6
      - .. figure:: ../images/action_history/attention.png
           :scale: 20%
      - Exastro実行時でエラーになった時に表示されるステータスアイコンです。
    * - 7
      - .. figure:: ../images/action_history/prevent.png
           :scale: 39%
      - アクション抑止済の時に表示されるステータスアイコンです。


| アクション履歴が1件も登録されていない場合は以下のように表示されます。

.. figure:: ../images/action_history/action_history_02.png
   :scale: 100%
   :align: center

   図 2.1-2 0件表示画面


| アクション履歴の詳細画面の画面構成は次のとおりです。

.. figure:: ../images/action_history/action_history_03.png
   :scale: 100%
   :align: center

   図 2.1-3 詳細画面構成


| アクション履歴の詳細画面の各構成要素と、その機能は次の表のとおりです。

.. csv-table:: 表 2.1-3 機能説明
   :header: No., 構成要素, 説明
   :widths: 5, 20, 60

   1, 作業画面名,現在表示している作業画面の名称です。
   2, リクエスト情報,リクエスト情報を表示します。
   3, アクション情報,アクション情報を表示します。ドライバ毎に表示される内容が異なります。
   4, ログ,アクション実行内容をログとして表示します。
   5, 閉じるボタン,ログ詳細画面を閉じてアクション履歴画面に戻ります。


2.2 アクション履歴画面の操作方法
================================

構成要素に対する操作方法を説明します。

(1)アクション履歴画面
---------------------
| 実行されたアクションの履歴を一覧で表示します。
| ここでは共通機能について説明します。


詳細表示ボタン
^^^^^^^^^^^^^^
* アクション履歴の詳細情報が表示されます。
* 大枠として「リクエスト情報」と「アクション情報」、「ログ」の3つに分かれています。
* 「アクション情報」はアクション種別により表示される情報が異なります。

.. figure:: ../images/action_history/action_history_04.png
   :scale: 100%
   :align: center

   図 2.2-1-1 「ルール種別：サンプル1」の詳細表示ボタンを押下した場合に表示される画面


ダウンロードボタン
^^^^^^^^^^^^^^^^^^
* 詳細表示ボタンで表示される詳細情報をテキストファイルとして、ダウンロードすることができます。

.. figure:: ../images/action_history/action_history_05.png
   :scale: 100%
   :align: center

   図 2.2-1-2 「ルール種別：サンプル1」のダウンロードボタン


承認ボタン
^^^^^^^^^^
* ディシジョンテーブルファイルのアクション実行前パラメータ情報を記述したルールがアクションされた際、アクション実行を保留中にすることができます。
* アクション履歴画面の承認ボタンから、アクション実行を行うか、実行せずに停止させるかを選択することができます。

.. figure:: ../images/action_history/action_history_06.png
   :scale: 100%
   :align: center

   図 2.2-1-3 「ルール種別：サンプル2」の承認ボタン

.. csv-table:: 表 2.2-1-3 承認ボタン説明
   :header: No., 構成要素, 説明
   :widths: 5, 20, 60

   1, 承認ボタン,保留中のアクションを再開または停止を行うことができます。
   2, キャンセルボタン,アクション履歴画面に戻ります。
   3, 再開ボタン,保留中のアクションを実行します。
   4, 停止ボタン,保留中のアクションを停止します。

.. note::
    保留中のアクションを停止した後、そのアクションは実行することが出来なくなります。
    また、同じイベント情報に複数のルールがヒットしていて、保留中のアクションを停止した場合、
    保留中のアクションの後に実行されるアクションも停止されます。
    なお、ディシジョンテーブル画面で設定する権限が「更新可能」でないユーザは承認ボタンの押下が出来ません。
    ルールが削除された場合も承認ボタンの押下が出来ません。


アクション再実行ボタン
^^^^^^^^^^^^^^^^^^^^^^
* エラーとなったアクションで再実行可能な場合、再度アクションを実行することができます。
* アクション再実行ボタンを押下すると「アクションを再実行しますがよろしいですか？」と確認メッセージが表示されます。
* 「OK」を選択すると、アクションが再実行され、アクション履歴画面に戻ります。

.. figure:: ../images/action_history/action_history_07.png
   :scale: 100%
   :align: center

   図 2.2-1-4 「ルール種別：サンプル1」のアクション再実行ボタン

.. note::
    ディシジョンテーブル画面で設定する権限が「更新可能」でないユーザはアクション再実行ボタンの押下が出来ません。
    ルールが削除された場合もアクション再実行ボタンの押下が出来ません。


一覧
^^^^

.. figure:: ../images/action_history/action_history_08.png
   :scale: 100%
   :align: center

   図 2.2-1-5 一覧に表示される項目


.. csv-table:: 表 2.2-1-5 一覧説明
   :header: No., 構成要素, 説明
   :widths: 5, 20, 60

   1, ルール種別,アクションされたルール種別が表示されます。
   2, ルール名,アクションされたルール名が表示されます。
   3, アクション種別,実行されたアクションドライバ名がバージョン付で表示されます。
   4, 最終実行日時,アクションが実行された日時が表示されます。
   5, 最終実行者,アクションを実行したユーザの名前が表示されます。


(2)アクション履歴詳細画面
-------------------------
| アクション履歴画面の一覧から各アクションの履歴詳細を確認することができます。


共通項目
^^^^^^^^
* 履歴詳細画面における、共通項目は次のとおりです。

.. figure:: ../images/action_history/action_history_09.png
   :scale: 100%
   :align: center

   図 2.2-2-1-1 アクション履歴詳細画面(共通項目)

.. figure:: ../images/action_history/action_history_10.png
   :scale: 100%
   :align: center

   図 2.2-2-1-2 アクション履歴詳細画面(共通項目)

.. csv-table:: 表 2.2-2-1 アクション履歴詳細画面(共通項目)の説明
   :header: No., 構成要素, 説明
   :widths: 5, 20, 60

   1, イベント発生日時,アクションが実行される起因となった、イベントの発生日時を表示します。
   2, トレースID,リクエスト情報の識別子です。
   3, イベント情報,リクエストされてきたイベント情報を表示します。
   4, アクション日時,アクション実行日時を表示します。
   5, トレースID,アクション情報の識別子です。項目2と同じ値が付与されます。
   6, ルール種別,アクション実行されたルール種別名を表示します。
   7, ルール名,アクション実行されたルール名を表示します。
   8, アクションパラメータ情報,アクションを行ったパラメータ情報を表示します。
   9, ログ情報,アクション実行のログを表示します。出力されるログにはメッセージIDが付与されています。


固有項目(ドライバ毎)
^^^^^^^^^^^^^^^^^^^^
* 履歴詳細画面における、Exastro IT Automation (以降、ITAと略) の項目は次の通りです。

.. figure:: ../images/action_history/action_history_12.png
   :scale: 100%
   :align: center

   図 2.2-2-2 固有項目(Exastro IT Automation)


.. csv-table:: 表 2.2-2-2 固有項目(Exastro IT Automation)の説明
   :header: No., 構成要素, 説明
   :widths: 5, 20, 60

   1, ITA表示名,ディシジョンテーブルファイルに記載した、ITA_NAMEが表示されます。
   2, Symphonyインスタンス番号,ITAで実行されたSymphony作業一覧のIDが表示されます。
   3, SymphonyクラスID,ITAで実行されたSymphonyクラス一覧のIDが表示されます。
   4, オペレーションID,ITAで実行された投入オペレーション一覧のIDが表示されます。
   5, Symphony作業確認URL,ITAの実行結果参照用の、Symphony作業確認のURLが表示されます。
   6, RESTAPI異常時の詳細内容,OASE-ITA間のREST結果が異常であった場合、エラー内容が表示されます。

* 履歴詳細画面における、mail の項目は次の通りです。

.. figure:: ../images/action_history/action_history_13.png
   :scale: 100%
   :align: center

   図 2.2-2-3 固有項目(mail)

.. csv-table:: 表 2.2-2-3 固有項目(mail)の説明
   :header: No., 構成要素, 説明
   :widths: 5, 20, 60

   1, メールテンプレート名,アクション実行により送信されたメールテンプレート名が表示されます。
   2, 送信先メールアドレス,アクション実行により送信されたメールアドレスが表示されます。

.. note::
    送信先メールアドレスはディシジョンテーブルファイルに記入したメールアドレスか、
    メールテンプレートで記入したメールアドレスか、わかるように表示しています。


ドライバのアンインストールについて
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
* アクション実行されていたドライバをアンインストールすると、ドライバ固有の項目が表示されなくなります。

.. figure:: ../images/action_history/action_history_11.png
   :scale: 100%
   :align: center

   図 2.2-2-4 ドライバアンインストールについて


